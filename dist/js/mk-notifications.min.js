/* 
MK Web Notifications v2.0.0 - JavaScript Plug-In JavaScript.
A easy to use JavaScript plug-in for in browser notifications and toasts.
Documentation: https://mahkassem.github.io/mk-web-notifications/.
LICENSE: MIT. 
*/
var icons={default:"fa fa-bell",primary:"fa fa-bell",success:"fa fa-check",danger:"fa fa-exclamation-triangle",warning:"fa fa-exclamation",info:"fa fa-info",light:"fa fa-bell",dark:"fa fa-bell",purple:"fa fa-bell"},defaultSound="./src/sound/notification.mp3",defaultClose="./src/sound/close.mp3",uniqueId=0,config={positionX:"right",positionY:"bottom",scrollable:!0,rtl:!1,max:5};function mkNotifications(t){t&&(config={positionX:null!=t.positionX?t.positionX:"right",positionY:null!=t.positionY?t.positionY:"bottom",scrollable:null==t.scrollable||t.scrollable,rtl:null!=t.rtl&&t.rtl,max:null!=t.max?t.max:5});var n=document.createElement("div");n.setAttribute("id","mk-notifications"),n.setAttribute("data-max",config.max),n.classList.add("mk-notifications"),n.classList.add("mk-"+config.positionY),n.classList.add("mk-"+config.positionX),config.scrollable&&n.classList.add("mk-scrollable"),config.rtl&&n.classList.add("mk-rtl");var l=document.getElementById("mk-notifications");null!=l&&l.remove(),document.querySelector("body").appendChild(n)}function mkNoti(t,n,l){var o=document.getElementById("mk-notifications"),e={status:"default",icon:{class:null,color:null,background:null},link:{url:null,target:"_self",function:null},dismissable:!0,callback:null,sound:!1,customSound:null,duration:7e3};l&&(e={status:null!=l.status?l.status:"default",icon:null==l.icon?e.icon:{class:null!=l.icon.class?l.icon.class:null,color:null!=l.icon.color?l.icon.color:null,background:null!=l.icon.background?l.icon.background:null},link:null==l.link?e.link:{url:null!=l.link.url?l.link.url:null,target:null!=l.link.target?l.link.target:"_self",function:null!=l.link.function?l.link.function:null},dismissable:null==l.dismissable||l.dismissable,callback:null!=l.callback?l.callback:null,sound:null!=l.sound&&l.sound,customSound:null==l.customSound?e.customSound:{onShow:null!=l.customSound.onShow?l.customSound.onShow:defaultSound,onClose:null!=l.customSound.onClose?l.customSound.onClose:defaultClose},duration:null!=l.duration?l.duration:7e3});var i=0,a=0;null!=t&&(i+=1.1*(a=t.length)),a>=70&&(t=t.substr(0,67)+"...");var u=0;null!=n&&(i+=u=n.length),i>=140?n="":u>=140-1.1*a&&(n=n.substr(0,140-1.1*a)+"...");var s="";null!=e.icon.color&&(s="color:"+e.icon.color+";");var c="";null!=e.icon.background&&(c="background:"+e.icon.background+";");var d;d=null!=e.icon.class?e.icon.class:icons[e.status];var r=uniqueId,m=null;null!=e.callback&&(m=!0);var k=" mk-hide",f=!1;1==e.dismissable&&(k="",f=!0);var b=!1,g=!1;!1!==e.sound&&(null!=e.customSound?(null!=e.customSound.onShow?(b=e.customSound.onShow,b=encodeURI(b)):(b=defaultSound,b=encodeURI(b)),null!=e.customSound.onClose?(g=e.customSound.onClose,g=encodeURI(g)):(g=defaultClose,g=encodeURI(g))):(b=defaultSound,b=encodeURI(b),g=defaultClose,g=encodeURI(g)));var p=document.createElement("div");p.setAttribute("id","mk-noti-"+r),p.setAttribute("class","mk-noti mk-"+e.status),p.setAttribute("data-unique",r),p.setAttribute("data-sound",b),p.setAttribute("data-close",g),p.setAttribute("data-dismiss",f),p.setAttribute("data-callback",m),p.setAttribute("data-duration",e.duration);var v=document.createElement("div");v.style.color=s,v.style.backgroundColor=c,v.setAttribute("class","mk-icon");var h=document.createElement("i");h.setAttribute("class",d),v.appendChild(h),p.appendChild(v);var S=document.createElement("div");S.setAttribute("class","mk-body");var A=document.createElement("i");A.setAttribute("id","mk-close-"+r),A.setAttribute("class","fa fa-times mk-close"+k),S.appendChild(A);var I=document.createElement("h3");I.setAttribute("class","mk-title"),I.innerHTML=t,S.appendChild(I);var C=document.createElement("p");C.setAttribute("class","mk-text"),C.innerHTML=n,S.appendChild(C),p.appendChild(S),o.appendChild(p);var y=document.getElementById("mk-close-"+r);y.addEventListener("click",function(t){t.stopImmediatePropagation(),closeMkNoti(r),1==m&&e.callback()});var L=document.getElementById("mk-noti-"+r);null!=e.link.url?(L.classList.add("mk-clickable"),L.addEventListener("click",function(t){t.stopImmediatePropagation(),window.open(e.link.url,e.link.target),null!=e.link.function&&e.link.function()})):null==e.link.url&&null!=e.link.function&&(L.classList.add("mk-clickable"),L.addEventListener("click",function(t){t.stopImmediatePropagation(),e.link.function()}));var w=document.querySelectorAll(".on-show").length,E=o.getAttribute("data-max");w<E||"null"==E?(setTimeout(function(){L.classList.add("mk-show"),L.classList.add("on-show"),mkSound(b)},100),setTimeout(function(){y&&y.click()},e.duration)):(L.classList.add("mk-pending"),console.log("pending:",uniqueId)),uniqueId++}function closeMkNoti(t){var n=document.getElementById("mk-noti-"+t);n&&(mkSound(n&&n.dataset.close),n.classList.remove("mk-show"),setTimeout(function(){n.remove();var t=document.querySelectorAll(".on-show").length,l=document.getElementById("mk-notifications").getAttribute("data-max");if(t<l||"null"==l)for(var o=l-t,e=0;e<o;e++){var i=document.querySelectorAll(".mk-pending").length-1,a=document.querySelectorAll(".mk-pending")[i];if(null!=a){var u=a.dataset.duration,s=a.dataset.dismiss,c=a.dataset.unique,d=a.dataset.sound;if(setTimeout(function(){showNext(a,d)},100),"true"==s){var r=document.getElementById("mk-close-"+c);setTimeout(function(){performClose(r)},u)}}}},400))}function performClose(t){t&&t.click()}function showNext(t,n){var l=document.querySelector("#"+t.id);l.classList.add("mk-show"),l.classList.add("on-show"),l.classList.remove("mk-pending"),mkSound(n)}function mkSound(t){"false"!==t&&!1!==t&&((t=new Audio(decodeURI(t))).loop=!1,t.play())}